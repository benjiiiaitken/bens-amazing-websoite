<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doors - A Horror Game</title>
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #fff;
            overflow: hidden;
            position: relative;
            background-size: cover;
            animation: flicker 0.5s infinite;
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        #home-screen, #game-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            position: relative;
        }

        #home-screen {
            background: rgba(0, 0, 0, 0.9);
            flex-direction: column;
            text-align: center;
        }

        #home-screen h1 {
            font-size: 3em;
            margin-bottom: 30px;
        }

        #home-screen button {
            background-color: #555;
            color: #fff;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            font-size: 1.2em;
        }

        #home-screen button:hover {
            background-color: #777;
        }

        #room {
            background-color: rgba(34, 34, 34, 0.9);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            width: 300px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
            position: relative;
            z-index: 1;
        }

        #next-door {
            background-color: #555;
            color: #fff;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            position: relative;
            z-index: 1;
        }

        #next-door:hover {
            background-color: #777;
        }

        #event {
            margin-top: 20px;
            font-style: italic;
        }

        /* Styles for Rush entity */
        #rush {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(255, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.9);
            display: none;
            z-index: 1000;
            animation: jitter 0.1s infinite;
            flex-direction: column;
            text-align: center;
        }

        #rush::before {
            content: "";
            background: url('https://static.wikia.nocookie.net/doors-ideas/images/9/99/Robert.png/revision/latest?cb=20230211202711') no-repeat center center;
            background-size: contain;
            width: 200px;
            height: 200px;
            display: block;
            margin-bottom: 20px;
        }

        @keyframes jitter {
            0% { transform: translateX(0) rotate(0); }
            25% { transform: translateX(-10px) rotate(-1deg); }
            50% { transform: translateX(10px) rotate(1deg); }
            75% { transform: translateX(-10px) rotate(-1deg); }
            100% { transform: translateX(0) rotate(0); }
        }

        /* Styles for Screech entity */
        #screech {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.9);
            display: none;
            z-index: 1000;
            animation: flicker 0.1s infinite;
            flex-direction: column;
            text-align: center;
        }

        #screech::before {
            content: "";
            background: url('https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/a2cd1f6c-da50-4bbe-89ac-77c7fc19e466/dfl8m8q-8f45145b-4b62-4319-88c7-e053d45813a6.png/v1/fill/w_600,h_800,q_80,strp/screech_by_demongod2022_dfl8m8q-fullview.png') no-repeat center center;
            background-size: contain;
            width: 200px;
            height: 200px;
            display: block;
            margin-bottom: 20px;
        }

        /* Styles for Dread entity */
        #dread {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.9);
            display: none;
            z-index: 1000;
            flex-direction: column;
            text-align: center;
        }

        #dread::before {
            content: "";
            background: url('https://static.wikia.nocookie.net/doors-game/images/c/c9/Dread.png/revision/latest?cb=20230909101425') no-repeat center center;
            background-size: contain;
            width: 200px;
            height: 200px;
            display: block;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div id="home-screen">
        <h1>Doors</h1>
        <button id="play-button">Play</button>
        <button id="settings-button">Settings</button>
        <button id="help-button">Help</button>
    </div>
    <div id="game-container" style="display: none;">
        <div id="room">
            <h1 id="room-title">Room 1</h1>
            <button id="next-door">Open Next Door</button>
            <div id="event"></div>
        </div>
    </div>
    <div id="rush">RUSH!</div>
    <div id="screech">SCREECH!</div>
    <div id="dread">DREAD!</div>
    <audio id="rush-sound" src="static/sounds/rush.mp3"></audio>
    <audio id="screech-sound" src="static/sounds/screech.mp3"></audio>
    <audio id="ambient-sound" src="static/sounds/ambient.mp3" loop></audio>
    <audio id="jump-scare-sound" src="static/sounds/jump-scare.mp3"></audio>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const roomTitle = document.getElementById('room-title');
            const eventDiv = document.getElementById('event');
            const nextDoorButton = document.getElementById('next-door');
            const rushDiv = document.getElementById('rush');
            const screechDiv = document.getElementById('screech');
            const dreadDiv = document.getElementById('dread');
            const rushSound = document.getElementById('rush-sound');
            const screechSound = document.getElementById('screech-sound');
            const ambientSound = document.getElementById('ambient-sound');
            const jumpScareSound = document.getElementById('jump-scare-sound');

            const homeScreen = document.getElementById('home-screen');
            const gameContainer = document.getElementById('game-container');
            const playButton = document.getElementById('play-button');
            const settingsButton = document.getElementById('settings-button');
            const helpButton = document.getElementById('help-button');

            let roomNumber = 1;
            let floorNumber = 1;
            let doorCount = 0;
            let startTime = Date.now();
            let isGameOver = false;
            let screechVisible = false;

            const events = [
                "You hear a distant scream.",
                "The lights flicker ominously.",
                "You find a mysterious note on the floor.",
                "A cold draft chills you to the bone.",
                "A shadow moves quickly past you.",
                "The floor creaks loudly.",
                "An eerie whisper fills the room.",
                "You feel an unseen presence.",
                "The walls seem to close in.",
                "A chilling breeze brushes your neck.",
            ];

            function getRandomEvent() {
                const randomIndex = Math.floor(Math.random() * events.length);
                return events[randomIndex];
            }

            function openNextDoor() {
                if (isGameOver) return;

                const currentTime = Date.now();
                const elapsedTime = (currentTime - startTime) / 1000; // in seconds

                // Check for Rush trigger
                if (doorCount >= 10 && elapsedTime <= 10) {
                    triggerRush();
                    return;
                }

                // Check for Screech trigger
                if (doorCount % 20 === 0 && doorCount > 0) {
                    showScreech();
                }

                // Check for Dread trigger
                if (doorCount === 30 && Math.random() < 0.01) {
                    triggerDread();
                    return;
                }

                roomNumber++;
                doorCount++;
                roomTitle.textContent = `Room ${roomNumber}`;
                eventDiv.textContent = getRandomEvent();

                // Reset timer and door count if more than 10 seconds have passed
                if (elapsedTime > 10) {
                    startTime = currentTime;
                    doorCount = 1; // Start counting again
                }

                // Spooky effects
                if (roomNumber % 10 === 0) {
                    document.body.style.backgroundColor = '#222';
                    setTimeout(() => document.body.style.backgroundColor = '#000', 500);
                }

                if (Math.random() > 0.7) {
                    document.body.style.backgroundColor = '#000';
                    setTimeout(() => document.body.style.backgroundColor = '#333', 300);
                }

                // Transition to Floor 2 after Room 100
                if (floorNumber === 1 && roomNumber > 100) {
                    transitionToFloor(2);
                }
            }

            function transitionToFloor(newFloor) {
                floorNumber = newFloor;
                roomNumber = 1;
                roomTitle.textContent = `Floor ${floorNumber} - Room ${roomNumber}`;
                eventDiv.textContent = "You have transitioned to a new floor.";
                
                // Optional: Add a special effect or message for the transition
                document.body.style.backgroundColor = '#444';
                setTimeout(() => document.body.style.backgroundColor = '#000', 500);
            }

            function triggerRush() {
                isGameOver = true;
                rushDiv.style.display = 'flex'; // Show Rush entity
                rushSound.play(); // Play Rush sound
                setTimeout(() => {
                    rushDiv.style.display = 'none'; // Hide Rush after a short period
                    nextDoorButton.disabled = true; // Disable button
                }, 2000); // Show for 2 seconds
            }

            function showScreech() {
                if (isGameOver) return;
                screechVisible = true;
                screechDiv.style.display = 'flex'; // Show Screech entity
                screechSound.play(); // Play Screech sound

                // Add event listener for clicking the Screech face
                document.addEventListener('click', handleScreechClick);

                // Hide Screech after 5 seconds if not clicked
                setTimeout(() => {
                    if (screechVisible) {
                        gameOver();
                    }
                }, 5000); // Show for 5 seconds
            }

            function handleScreechClick(event) {
                const rect = screechDiv.getBoundingClientRect();
                const x = event.clientX;
                const y = event.clientY;

                if (
                    x >= rect.left &&
                    x <= rect.right &&
                    y >= rect.top &&
                    y <= rect.bottom
                ) {
                    screechVisible = false;
                    screechDiv.style.display = 'none'; // Hide Screech
                    document.removeEventListener('click', handleScreechClick);
                }
            }

            function triggerDread() {
                isGameOver = true;
                dreadDiv.style.display = 'flex'; // Show Dread entity
                setTimeout(() => {
                    dreadDiv.style.display = 'none'; // Hide Dread after a short period
                    nextDoorButton.disabled = true; // Disable button
                }, 2000); // Show for 2 seconds
            }

            function gameOver() {
                isGameOver = true;
                screechDiv.style.display = 'none'; // Hide Screech immediately
                dreadDiv.style.display = 'none'; // Hide Dread immediately
                nextDoorButton.disabled = true; // Disable button
                jumpScareSound.play(); // Play jump scare sound
                alert('You have been caught by Screech!');
            }

            function startGame() {
                homeScreen.style.display = 'none';
                gameContainer.style.display = 'flex';
                ambientSound.play(); // Play ambient sound when game starts
            }

            function showSettings() {
                alert('Settings screen is not implemented yet.'); // Placeholder for settings
            }

            function showHelp() {
                alert('Help screen is not implemented yet.'); // Placeholder for help
            }

            playButton.addEventListener('click', startGame);
            settingsButton.addEventListener('click', showSettings);
            helpButton.addEventListener('click', showHelp);

            if (nextDoorButton) {
                nextDoorButton.addEventListener('click', () => {
                    if (floorNumber === 1 && roomNumber <= 100) {
                        openNextDoor(); // Proceed normally
                    } else if (floorNumber === 2 && roomNumber <= 100) {
                        openNextDoor(); // Continue in Floor 2
                    } else if (floorNumber === 2 && roomNumber > 100) {
                        roomTitle.textContent = 'You have escaped!';
                        eventDiv.textContent = 'Congratulations, you have reached the end!';
                        nextDoorButton.disabled = true;
                    }
                });
            }
        });
    </script>
</body>
</html>
